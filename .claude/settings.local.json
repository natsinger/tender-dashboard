{
  "permissions": {
    "allow": [
      "Bash(python:*)",
      "Bash(\"c:\\\\Users\\\\nathanaels\\\\Desktop\\\\code\\\\Gov tender projects\\\\venv\\\\Scripts\\\\python.exe\" \"c:\\\\Users\\\\nathanaels\\\\Desktop\\\\code\\\\Gov tender projects\\\\test_fetch_tenders.py\")",
      "Bash(\"c:\\\\Users\\\\nathanaels\\\\Desktop\\\\code\\\\Gov tender projects\\\\venv\\\\Scripts\\\\python.exe\" -m pip show streamlit)",
      "Bash(\"c:\\\\Users\\\\nathanaels\\\\Desktop\\\\code\\\\Gov tender projects\\\\venv\\\\Scripts\\\\python.exe\" \"c:\\\\Users\\\\nathanaels\\\\Desktop\\\\code\\\\Gov tender projects\\\\test_detail_api.py\")",
      "Bash(\"venv\\\\Scripts\\\\python.exe\":*)",
      "Bash(timeout:*)",
      "Bash(\"venv\\\\Scripts\\\\python.exe\" -c:*)",
      "Bash(dir:*)",
      "Bash(\"venv\\\\Scripts\\\\python.exe\" find_missing_cities.py)",
      "WebFetch(domain:www.cbs.gov.il)",
      "Bash(\"venv\\\\Scripts\\\\streamlit.exe\" run app.py --server.headless true)",
      "Bash(\"venv\\\\Scripts\\\\pip.exe\" install:*)",
      "Bash(\"venv\\\\Scripts\\\\python.exe\" -c \"\nfrom data_client import LandTendersClient\nimport pandas as pd\n\nclient = LandTendersClient\\(data_dir=''data''\\)\ndf = client.load_latest_json_snapshot\\(\\)\n\nprint\\(''='' * 80\\)\nprint\\(''CITY FIELD ANALYSIS''\\)\nprint\\(''='' * 80\\)\n\n# Check for problematic city values \\(containing street indicators\\)\nstreet_indicators = [''שדי'', ''שדרות'', ''רחוב'', ''מס'', \"\"''\"\"]\nproblem_cities = df[df[''city''].str.contains\\(''|''.join\\(street_indicators\\), na=False, case=False\\)]\n\nprint\\(f''\\\\nTotal tenders: {len\\(df\\):,}''\\)\nprint\\(f''Tenders with street names in city field: {len\\(problem_cities\\):,}''\\)\n\nif len\\(problem_cities\\) > 0:\n    print\\(''\\\\nSample problematic entries:''\\)\n    sample = problem_cities[[''tender_id'', ''city_code'', ''city'', ''location'']].head\\(10\\)\n    pd.set_option\\(''display.max_colwidth'', 50\\)\n    print\\(sample.to_string\\(index=False\\)\\)\n    \n    print\\(''\\\\n'' + ''='' * 80\\)\n    print\\(''City codes for problematic entries:''\\)\n    print\\(problem_cities[''city_code''].value_counts\\(\\).head\\(20\\).to_string\\(\\)\\)\n\nprint\\(''\\\\n'' + ''='' * 80\\)\nprint\\(''Unique city values \\(first 50\\):''\\)\nunique_cities = sorted\\(df[''city''].unique\\(\\)\\)[:50]\nfor i, city in enumerate\\(unique_cities, 1\\):\n    print\\(f''{i:3}. {city}''\\)\n\")",
      "Bash(\"venv\\\\Scripts\\\\python.exe\" debug_data_flow.py)",
      "Bash(iconv:*)",
      "Bash(ls test_*.py debug_*.py analyze_*.py sample_detail_*.json data_flow_hebrew.html find_missing_cities.py)",
      "Bash(.venvScriptspython.exe:*)",
      "Bash(\".\\\\venv\\\\Scripts\\\\python.exe\" -c \"import json; f=open\\(''tenders_list_11_02_2026.json'',''r'',encoding=''utf-8''\\); data=json.load\\(f\\); f.close\\(\\); import pandas as pd; df=pd.DataFrame\\(data\\); print\\(''=== tender_type_code ===''\\); print\\(df[''tender_type_code''].value_counts\\(\\)\\); print\\(\\); print\\(''=== purpose_code ===''\\); print\\(df[''purpose_code''].value_counts\\(\\)\\); print\\(\\); print\\(''=== KhalYaadRashi ===''\\); print\\(df[''KhalYaadRashi''].value_counts\\(\\)\\); print\\(\\); print\\(''=== KodMerchav ===''\\); print\\(df[''KodMerchav''].value_counts\\(\\)\\)\")",
      "Bash(\".\\\\venv\\\\Scripts\\\\python.exe\" -c:*)",
      "WebFetch(domain:apps.land.gov.il)",
      "Bash(\".\\\\venv\\\\Scripts\\\\python.exe\" -c \"\nimport requests, json\n\nheaders = {\n    ''User-Agent'': ''Mozilla/5.0 \\(Windows NT 10.0; Win64; x64\\) AppleWebKit/537.36'',\n    ''Accept'': ''application/json'',\n}\n\n# Try to discover lookup/enum endpoints on the RMI API\nendpoints_to_try = [\n    ''https://apps.land.gov.il/MichrazimSite/api/SearchApi/GetLookups'',\n    ''https://apps.land.gov.il/MichrazimSite/api/SearchApi/GetFilters'',\n    ''https://apps.land.gov.il/MichrazimSite/api/SearchApi/GetSugMichrazim'',\n    ''https://apps.land.gov.il/MichrazimSite/api/SearchApi/GetCodeTable'',\n    ''https://apps.land.gov.il/MichrazimSite/api/LookupApi/GetAll'',\n    ''https://apps.land.gov.il/MichrazimSite/api/LookupApi/Get'',\n]\n\nfor url in endpoints_to_try:\n    try:\n        resp = requests.get\\(url, headers=headers, timeout=10\\)\n        print\\(f''{resp.status_code} - {url}''\\)\n        if resp.status_code == 200:\n            data = resp.json\\(\\)\n            print\\(f''  Data: {json.dumps\\(data, ensure_ascii=False\\)[:500]}''\\)\n    except Exception as e:\n        print\\(f''ERROR - {url}: {e}''\\)\n    print\\(\\)\n\")",
      "Bash(curl:*)",
      "Bash(\".\\\\venv\\\\Scripts\\\\python.exe\":*)",
      "Bash(\".\\\\venv\\\\Scripts\\\\python.exe\" -c \"\nimport requests\nimport json\n\n# First get the actual detail data with full document info\nr = requests.get\\(''https://apps.land.gov.il/MichrazimSite/api/MichrazDetailsApi/Get?michrazID=20250351'', timeout=10\\)\ndetail = r.json\\(\\)\n\n# Get first doc with all fields\ndocs = detail.get\\(''MichrazDocList'', []\\)\nfull_doc = detail.get\\(''MichrazFullDocument'', {}\\)\n\nprint\\(''=== MichrazFullDocument ===''\\)\nprint\\(json.dumps\\(full_doc, indent=2, ensure_ascii=False\\)\\)\n\nprint\\(''\\\\n=== First 2 MichrazDocList items ===''\\)\nfor d in docs[:2]:\n    print\\(json.dumps\\(d, indent=2, ensure_ascii=False\\)\\)\n    print\\(\\)\n\")",
      "Bash(\".\\\\venv\\\\Scripts\\\\python.exe\" -c \"\nimport requests\n\nbase = ''https://apps.land.gov.il/MichrazimSite/api''\n\n# POST with allow_redirects=False to see where it redirects to\npayload = {\n    ''MichrazID'': 20250351,\n    ''RowID'': -1,\n    ''Size'': 215509,\n    ''PirsumType'': 2,\n    ''FileType'': ''application/pdf'',\n    ''DocName'': ''test.pdf'',\n    ''Teur'': ''test'',\n}\nr = requests.post\\(f''{base}/MichrazDetailsApi/GetFileContent'', json=payload, timeout=10, allow_redirects=False\\)\nprint\\(f''Status: {r.status_code}''\\)\nprint\\(f''Location: {r.headers.get\\(\"\"Location\"\", \"\"N/A\"\"\\)}''\\)\nprint\\(f''Headers: {dict\\(r.headers\\)}''\\)\nprint\\(f''Body: {r.text[:500]}''\\)\nprint\\(\\)\n\n# Follow redirect manually\nr2 = requests.post\\(f''{base}/MichrazDetailsApi/GetFileContent'', json=payload, timeout=10, allow_redirects=True\\)\nprint\\(f''After redirect: [{r2.status_code}] Content-Type: {r2.headers.get\\(\"\"Content-Type\"\"\\)} Length: {len\\(r2.content\\)}''\\)\nprint\\(f''Final URL: {r2.url}''\\)\nprint\\(f''Body preview: {r2.content[:200]}''\\)\n\")",
      "Bash(\".\\\\venv\\\\Scripts\\\\python.exe\" -c \"\nimport requests\nimport json\n\nbase = ''https://apps.land.gov.il/MichrazimSite/api''\n\n# Test GetPirsum endpoint \\(seen in JS bundle\\)\nurl = f''{base}/MichrazDetailsApi/GetPirsum?michrazDoc?=111239''\nr = requests.get\\(url, timeout=10\\)\nprint\\(f''GetPirsum: [{r.status_code}] CT: {r.headers.get\\(\"\"Content-Type\"\"\\)}''\\)\n\n# Try POST to GetFileContent for regular doc\ndoc_payload = {\n    ''MichrazID'': 20250351,\n    ''RowID'': 111239,\n    ''Size'': None,\n    ''PirsumType'': 3,\n    ''FileType'': ''application/pdf'',\n    ''DocName'': ''test.pdf'',\n    ''Teur'': ''test'',\n}\nr2 = requests.post\\(f''{base}/MichrazDetailsApi/GetFileContent'', json=doc_payload, timeout=10\\)\nct = r2.headers.get\\(''Content-Type'', ''N/A''\\)\ncd = r2.headers.get\\(''Content-Disposition'', ''N/A''\\)\nprint\\(f''POST regular doc: [{r2.status_code}] CT: {ct} Len: {len\\(r2.content\\)} Disp: {cd}''\\)\nif r2.status_code == 200 and ''pdf'' in ct.lower\\(\\):\n    print\\(''SUCCESS - Got PDF via POST!''\\)\n    # Save it to verify it''s a real PDF\n    with open\\(''tmp/test_download.pdf'', ''wb''\\) as f:\n        f.write\\(r2.content\\)\n    print\\(f''Saved to tmp/test_download.pdf \\({len\\(r2.content\\)} bytes\\)''\\)\n\")",
      "Bash(ls:*)",
      "Bash(pip install:*)",
      "WebFetch(domain:mavat.iplan.gov.il)",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:data.gov.il)",
      "WebFetch(domain:ags.iplan.gov.il)",
      "Bash(for endpoint in \"Entity\" \"PlanData\" \"Documents\" \"Attachments\" \"Attacments\" \"Plan\" \"Plans\" \"Meetings\" \"StatusList\" \"EntityTypes\" \"SearchTypes\")",
      "Bash(do echo -n \"$endpoint: \")",
      "Bash(done)",
      "Bash(do echo -n \"POST $endpoint: \")",
      "Bash(grep:*)",
      "Bash(./venv/Scripts/python.exe:*)",
      "Bash(gh pr create:*)",
      "Bash(where:*)",
      "Bash(git fetch:*)",
      "WebFetch(domain:raw.githubusercontent.com)",
      "Bash(taskkill:*)",
      "Bash(findstr:*)",
      "Bash(git add:*)",
      "Bash(GIT_EDITOR=true git rebase:*)",
      "Bash(git push:*)",
      "Bash(git status:*)"
    ]
  }
}
